OVERRIDE(CONFIG,E=>{global.CONFIG=COMBINE([{defaultBoxName:"UPPERCASE",title:"UPPERCASE PROJECT"},E])});OVERRIDE(BROWSER_CONFIG,O=>{global.BROWSER_CONFIG=COMBINE([{},O])});global.CONNECT_TO_UPPERCASE_SERVER=METHOD({run:(e,o)=>{let n,r,E,i,t,O;void 0===o?void 0!==e&&(CHECK_IS_DATA(e)!==!0?t=e:(n=e.roomServerName,r=e.webServerHost,E=e.webServerPort,i=e.isSecure,t=e.success,O=e.error)):(void 0!==e&&(n=e.roomServerName,r=e.webServerHost,E=e.webServerPort,i=e.isSecure),CHECK_IS_DATA(o)!==!0?t=o:(t=o.success,O=o.error)),void 0===r&&(r=BROWSER_CONFIG.host),void 0===E&&(E=CONFIG.webServerPort),void 0===i&&(i=BROWSER_CONFIG.isSecure),SYNC_TIME();let C=RAR(()=>{isConnecting!==!0&&(isConnecting=!0,CONNECT_TO_UPPERCASE_SERVER(e=>{FOR_BOX(e=>{void 0!==e.CONNECTED&&e.CONNECTED()}),e("__DISCONNECTED",()=>{FOR_BOX(e=>{void 0!==e.DISCONNECTED&&e.DISCONNECTED()}),isConnecting=!1;let e=INTERVAL(1,RAR(()=>{GET({port:CONFIG.webServerPort,uri:"__VERSION"},o=>{void 0!==e&&(e.remove(),e=void 0,("TEXTAREA"!==document.activeElement.tagName&&"INPUT"!==document.activeElement.tagName||void 0===BROWSER_CONFIG.beforeUnloadMessage||confirm(BROWSER_CONFIG.beforeUnloadMessage)===!0)&&(void 0!==BROWSER_CONFIG.reconnect&&BROWSER_CONFIG.reconnect(CONFIG.version===o,C)===!1||(CONFIG.version===o?(REFRESH(),C()):location.reload())))})}))})}))});GET({isSecure:i,host:r,port:E,uri:"__WEB_SOCKET_SERVER_HOST",paramStr:"defaultHost="+r},{error:O,success:e=>{CONNECT_TO_ROOM_SERVER({roomServerName:n,isSecure:i,host:e,port:E},(e,o,n)=>{FOR_BOX(e=>{EACH(e.MODEL.getOnNewInfos(),e=>{e.findMissingDataSet()})}),e("__DISCONNECTED",()=>{FOR_BOX(e=>{EACH(e.MODEL.getOnNewInfos(),e=>{e.lastCreateTime=SERVER_TIME(new Date)})})}),void 0!==t&&t(e,o,n)})}})}});FOR_BOX(o=>{o.R=METHOD(n=>{let i;n.setBasePath=(o=>{i=o});return{run:(n,t)=>{let e=o.boxName+"/R/"+n;return void 0!==CONFIG.version&&(e+="?version="+CONFIG.version),void 0!==i&&(e=i+"/"+e),"file:"!==location.protocol&&(e="/"+e),void 0!==t&&GET(e,t),e}}})});FOR_BOX(n=>{n.RF=METHOD({run:u=>{return"/__RF/"+n.boxName+"/"+u}})});global.SERVER_TIME=METHOD(n=>{let t=0;n.setDiff=(n=>{t=n});return{run:n=>{return new Date(n.getTime()-t)}}});global.SYNC_TIME=METHOD({run:()=>{let n=UPPERCASE.ROOM("timeSyncRoom");n.send({methodName:"sync",data:new Date},n=>{TIME.setDiff(n),SERVER_TIME.setDiff(n)})}});global.TIME=METHOD(n=>{let t=0;n.setDiff=(n=>{t=n});return{run:n=>{return new Date(n.getTime()+t)}}});