global.CONNECT_TO_ROOM_SERVER=METHOD(function(e){"use strict";var o,t,d,r,a,m,i="__",n={},v={},c={},u={},E={},N={},h={};return e.checkIsConnected=o=function(e){return void 0===e&&(e=i),void 0===u[e]&&(u[e]=!1),u[e]},e.enterRoom=t=function(e){var o,t=e.roomServerName,d=e.roomName;void 0===t&&(t=i),o=n[t],void 0===o&&(o=n[t]=[]),o.push(d),void 0!==h[t]&&h[t]({methodName:"__ENTER_ROOM",data:d})},e.on=d=function(e,o){var t,d=e.roomServerName,r=e.methodName;void 0===d&&(d=i),t=v[d],void 0===t&&(t=v[d]=[]),t.push({methodName:r,method:o}),void 0!==E[d]&&E[d](r,o)},e.off=r=function(e,o){var t,d=e.roomServerName,r=e.methodName;void 0===d&&(d=i),t=v[d],void 0!==N[d]&&N[d](r,o),void 0!==t&&(void 0!==o?REMOVE(t,function(e){return e.methodName===r&&e.method===o}):REMOVE(t,function(e){return e.methodName===r}),0===t.length&&delete v[d])},e.send=a=function(e,o){var t,d=e.roomServerName,r=e.methodName,a=e.data;void 0===d&&(d=i),void 0===h[d]?(t=c[d],void 0===t&&(t=c[d]=[]),t.push({params:{methodName:r,data:a},callback:o})):h[d]({methodName:r,data:a},o)},e.exitRoom=m=function(e){var o,t=e.roomServerName,d=e.roomName;void 0===t&&(t=i),o=n[t],void 0===o&&(o=n[t]=[]),void 0!==h[t]&&h[t]({methodName:"__EXIT_ROOM",data:d}),EACH(o,function(e,t){if(e===d)return REMOVE({array:o,key:t}),!1})},{run:function(e,o){var t,d,r=e.name;void 0===r&&(r=i),void 0!==o&&(CHECK_IS_DATA(o)!==!0?t=o:(t=o.success,d=o.error)),CONNECT_TO_WEB_SOCKET_SERVER({isSecure:e.isSecure,host:e.host,port:e.port},{error:d,success:function(e,o,d){var a=n[r],m=v[r],i=c[r];E[r]=e,N[r]=o,h[r]=d,void 0!==a&&EACH(a,function(e){d({methodName:"__ENTER_ROOM",data:e})}),void 0!==m&&EACH(m,function(o){e(o.methodName,o.method)}),void 0!==i&&EACH(i,function(e){d(e.params,e.callback)}),delete c[r],void 0!==t&&t(e,o,d),u[r]=!0,e("__DISCONNECTED",function(){delete E[r],delete N[r],delete h[r],u[r]=!1})}})}}});FOR_BOX(function(e){"use strict";e.ROOM=CLASS({init:function(o,O,m){var r,n,R,t,E,a,N,_,i,C={};CHECK_IS_DATA(m)!==!0?n=e.boxName+"/"+m:(r=m.roomServerName,n=e.boxName+"/"+m.name),CONNECT_TO_ROOM_SERVER.enterRoom({roomServerName:r,roomName:n}),o.getRoomName=t=function(){return n},o.checkIsExited=E=function(){return R},O.on=a=function(e,o){var O=C[e];CONNECT_TO_ROOM_SERVER.on({roomServerName:r,methodName:n+"/"+e},o),void 0===O&&(O=C[e]=[]),O.push(o)},O.off=N=function(e,o){var O=C[e];void 0!==O&&(void 0!==o?(CONNECT_TO_ROOM_SERVER.off({roomServerName:r,methodName:n+"/"+e},o),REMOVE({array:O,value:o}),0===O.length&&delete C[e]):(EACH(O,function(o){CONNECT_TO_ROOM_SERVER.off({roomServerName:r,methodName:n+"/"+e},o)}),delete C[e]))},O.send=_=function(e,o){var O,m;CHECK_IS_DATA(e)!==!0?O=e:(O=e.methodName,m=e.data),R!==!0?CONNECT_TO_ROOM_SERVER.send({roomServerName:r,methodName:n+"/"+O,data:m},o):console.log("[UPPERCASE-ROOM] `ROOM.send` ERROR! ROOM EXITED!")},O.exit=i=function(){R!==!0&&(CONNECT_TO_ROOM_SERVER.exitRoom({roomServerName:r,roomName:n}),EACH(C,function(e,o){N(o)}),C=void 0,R=!0)}}})});