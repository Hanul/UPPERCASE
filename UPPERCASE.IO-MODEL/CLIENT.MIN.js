FOR_BOX(function(o){"use strict";o.MODEL=CLASS({init:function(e,t,n){var i,r,d,c,u,v,a,s,E,O,f,A,C,R,l,N,m,g,h,D,x,I,M,S,P,T,H,U,L=n.roomServerName,p=n.name,_=n.initData,b=n.methodConfig,k=(n.isNotUsingObjectId,o.ROOM({roomServerName:L,name:p}));void 0!==b&&(i=b.create,r=b.get,d=b.update,c=b.remove,u=b.find,v=b.count,a=b.checkIsExists,void 0!==i&&(s=i.valid),void 0!==d&&(E=d.valid)),t.getName=O=function(){return p},t.getInitData=f=function(){return _},t.getCreateValid=A=function(){return s},t.getUpdateValid=C=function(){return E},t.getRoom=R=function(){return k},i!==!1&&(t.create=l=function(e,t){var n,i,r,d,c;void 0!==t&&(CHECK_IS_DATA(t)!==!0?n=t:(n=t.success,i=t.notValid,r=t.notAuthed,d=t.error)),void 0!==_&&EACH(_,function(o,t){e[t]=o}),void 0!==s&&(c=s.check(e)),void 0!==c&&c.checkHasError()===!0?void 0!==i?i(c.getErrors()):console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/create` NOT VALID!: ",c.getErrors()):k.send({methodName:"create",data:e},function(e){var t,c,u,v;void 0!==e?(t=e.errorMsg,c=e.validErrors,u=e.isNotAuthed,v=e.savedData,void 0!==t?void 0!==d?d(t):console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/create` ERROR: "+t):void 0!==c?void 0!==i?i(c):console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/create` NOT VALID!: ",c):u===!0?void 0!==r?r():console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/create` NOT AUTHED!"):void 0!==n&&n(v)):void 0!==n&&n()})}),r!==!1&&(t.get=N=function(e,t){var n,i,r,d;CHECK_IS_DATA(t)!==!0?n=t:(n=t.success,i=t.notExists,r=t.notAuthed,d=t.error),k.send({methodName:"get",data:e},function(e){var t,c,u;void 0!==e&&(t=e.errorMsg,c=e.isNotAuthed,u=e.savedData),void 0!==t?void 0!==d?d(t):console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/get` ERROR: "+t):c===!0?void 0!==r?r():console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/get` NOT AUTHED!"):void 0===u?void 0!==i?i():console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/get` NOT EXISTS!"):void 0!==n&&n(u)})},t.getWatching=m=function(e,n){var i,r,d,c,u,v;return CHECK_IS_DATA(n)!==!0?i=n:(i=n.success,r=n.notExists,d=n.notAuthed,c=n.error),t.get(e,{success:function(e){var t;u!==!0&&void 0!==i&&(v=o.ROOM(p+"/"+e.id),i(e,function(o){v.on("update",o)},function(o){v.on("remove",function(e){o(e),t()})},t=function(){void 0!==v&&(v.exit(),v=void 0)}))},notExists:r,notAuthed:d,error:c}),OBJECT({init:function(o,e){var t;e.exit=t=function(){void 0!==v&&v.exit(),u=!0}}})}),d!==!1&&(t.update=g=function(e,t){var n,i,r,d,c,u,v,a,s,O,f=e.id,A=e.$inc,C=e.$push,R=e.$pull;void 0!==t&&(CHECK_IS_DATA(t)!==!0?n=t:(n=t.success,i=t.notValid,r=t.notExists,d=t.notAuthed,c=t.error)),void 0!==E&&(u=E.checkForUpdate(e),void 0!==A&&(v=E.checkForUpdate(A)),void 0!==C&&(a=E.checkForUpdate(RUN(function(){var o={};return EACH(C,function(e,t){o[t]=[e]}),o}))),void 0!==R&&(s=E.checkForUpdate(RUN(function(){var o={};return EACH(R,function(e,t){o[t]=[e]}),o})))),e.id=f,e.$inc=A,e.$push=C,e.$pull=R,void 0!==E&&(u.checkHasError()===!0||void 0!==v&&v.checkHasError()===!0||void 0!==a&&a.checkHasError()===!0||void 0!==s&&s.checkHasError()===!0)?(O=COMBINE([u.getErrors(),void 0===v?{}:v.getErrors(),void 0===a?{}:a.getErrors(),void 0===s?{}:s.getErrors()]),void 0!==i?i(O):console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/update` NOT VALID!: ",O)):k.send({methodName:"update",data:e},function(e){var t,u,v,a,s;void 0!==e&&(t=e.errorMsg,u=e.validErrors,v=e.isNotAuthed,a=e.savedData,s=e.originData),void 0!==t?void 0!==c?c(t):console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/update` ERROR: "+t):void 0!==u?void 0!==i?i(u):console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/update` NOT VALID!: ",u):v===!0?void 0!==d?d():console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/update` NOT AUTHED!"):void 0===a?void 0!==r?r():console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/update` NOT EXISTS!"):void 0!==n&&n(a,s)})}),c!==!1&&(t.remove=h=function(e,t){var n,i,r,d;void 0!==t&&(CHECK_IS_DATA(t)!==!0?n=t:(n=t.success,i=t.notExists,r=t.notAuthed,d=t.error)),k.send({methodName:"remove",data:e},function(e){var t,c,u;void 0!==e&&(t=e.errorMsg,c=e.isNotAuthed,u=e.originData),void 0!==t?void 0!==d?d(t):console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/remove` ERROR: "+t):c===!0?void 0!==r?r():console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/remove` NOT AUTHED!"):void 0===u?void 0!==i?i():console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/remove` NOT EXISTS!"):void 0!==n&&n(u)})}),u!==!1&&(t.find=D=function(e,t){var n,i,r;void 0===t&&(t=e,e=void 0),CHECK_IS_DATA(t)!==!0?n=t:(n=t.success,i=t.notAuthed,r=t.error),k.send({methodName:"find",data:e},function(e){var t=e.errorMsg,d=e.isNotAuthed,c=e.savedDataSet;void 0!==t?void 0!==r?r(t):console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/find` ERROR: "+t):d===!0?void 0!==i?i():console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/find` NOT AUTHED!"):void 0!==n&&n(c)})},t.findWatching=x=function(e,n){var i,r,d,c,u={};return void 0===n&&(n=e,e=void 0),CHECK_IS_DATA(n)!==!0?i=n:(i=n.success,r=n.notAuthed,d=n.error),t.find(e,{success:function(e){var t;c!==!0&&void 0!==i&&(EACH(e,function(e){var t=e.id;u[t]=o.ROOM(p+"/"+t)}),i(e,function(o,e){u[o].on("update",e)},function(o,e){u[o].on("remove",function(n){e(n),t(o)})},t=function(o){void 0!==u[o]&&(u[o].exit(),delete u[o])}))},notAuthed:r,error:d}),OBJECT({init:function(o,e){var t;e.exit=t=function(){EACH(u,function(o){o.exit()}),c=!0}}})}),v!==!1&&(t.count=I=function(e,t){var n,i,r;void 0===t&&(t=e,e=void 0),CHECK_IS_DATA(t)!==!0?n=t:(n=t.success,i=t.notAuthed,r=t.error),k.send({methodName:"count",data:e},function(e){var t=e.errorMsg,d=e.isNotAuthed,c=e.count;void 0!==t?void 0!==r?r(t):console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/count` ERROR: "+t):d===!0?void 0!==i?i():console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/count` NOT AUTHED!"):void 0!==n&&n(c)})}),a!==!1&&(t.checkIsExists=M=function(e,t){var n,i,r;void 0===t&&(t=e,e=void 0),CHECK_IS_DATA(t)!==!0?n=t:(n=t.success,i=t.notAuthed,r=t.error),k.send({methodName:"checkIsExists",data:e},function(e){var t=e.errorMsg,d=e.isNotAuthed,c=e.isExists;void 0!==t?void 0!==r?r(t):console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/checkIsExists` ERROR: "+t):d===!0?void 0!==i?i():console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/checkIsExists` NOT AUTHED!"):void 0!==n&&n(c)})}),t.onNew=S=function(e,t){var n;return void 0===t?(t=e,(n=o.ROOM(p+"/create")).on("create",t)):void 0===e?(n=o.ROOM(p+"/create")).on("create",t):EACH(e,function(i,r){return(n=o.ROOM(p+"/"+r+"/"+i+"/create")).on("create",function(o){EACH(e,function(e,t){return o[t]!==e?!1:void 0})===!0&&t(o)}),!1}),OBJECT({init:function(o,e){var t;e.exit=t=function(){void 0!==n&&n.exit()}}})},t.onNewWatching=P=function(e,t){var n,i=[],r=function(e){var n,r,d=e.id;i.push(n=o.ROOM(p+"/"+d)),t(e,function(o){n.on("update",o)},function(o){n.on("remove",function(e){o(e),r()})},r=function(){n.exit(),REMOVE({array:i,value:n})})};return void 0===t?(t=e,(n=o.ROOM(p+"/create")).on("create",function(o){r(o)})):void 0===e?(n=o.ROOM(p+"/create")).on("create",function(o){r(o)}):EACH(e,function(t,i){return(n=o.ROOM(p+"/"+i+"/"+t+"/create")).on("create",function(o){EACH(e,function(e,t){return o[t]!==e?!1:void 0})===!0&&r(o)}),!1}),OBJECT({init:function(o,e){var t;e.exit=t=function(){void 0!==n&&n.exit(),EACH(i,function(o){o.exit()})}}})},u!==!1&&(t.onNewAndFind=T=function(o,e){var t,n,i,r,d,c,u,v,a,s;return void 0===e&&(e=o,o=void 0),void 0!==o&&(t=o.properties,n=o.filter,i=o.sort,r=o.start,d=o.count),CHECK_IS_DATA(e)!==!0?u=e:(u=e.handler,v=e.success,a=e.notAuthed,s=e.error),void 0!==n||void 0!==i||void 0!==r&&0!==r||(c=S(t,u)),D({filter:COMBINE([t,n]),sort:i,start:r,count:d},{success:function(o){void 0!==v&&v(o),REVERSE_EACH(o,u)},notAuthed:a,error:s}),OBJECT({init:function(o,e){var t;e.exit=t=function(){void 0!==c&&c.exit()}}})},t.onNewAndFindWatching=H=function(o,e){var t,n,i,r,d,c,u,v,a,s,E;return void 0===e&&(e=o,o=void 0),void 0!==o&&(t=o.properties,n=o.filter,i=o.sort,r=o.start,d=o.count),CHECK_IS_DATA(e)!==!0?v=e:(v=e.handler,a=e.success,s=e.notAuthed,E=e.error),void 0!==n||void 0!==i||void 0!==r&&0!==r||(c=P(t,v)),u=x({filter:COMBINE([t,n]),sort:i,start:r,count:d},{success:function(o,e,t){void 0!==a&&a(o,e,t),REVERSE_EACH(o,function(o){v(o,function(t){e(o.id,t)},function(e){t(o.id,e)})})},notAuthed:s,error:E}),OBJECT({init:function(o,e){var t;e.exit=t=function(){void 0!==c&&c.exit(),u.exit()}}})}),t.onRemove=U=function(e,t){var n;return void 0===t?(t=e,(n=o.ROOM(p+"/remove")).on("remove",t)):EACH(e,function(i,r){return(n=o.ROOM(p+"/"+r+"/"+i+"/remove")).on("remove",function(o){EACH(e,function(e,t){return o[t]!==e?!1:void 0})===!0&&t(o)}),!1}),OBJECT({init:function(o,e){var t;e.exit=t=function(){void 0!==n&&n.exit()}}})}}})});